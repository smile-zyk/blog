# PhysX引擎
unity中的物理引擎实际上是直接使用了现有的物理引擎PhysX。  
物理运算引擎的作用，简而言之，就是令虚拟世界中的物体运动符合真实世界的物理定律，以使游戏更加富有真实感。  

## PhysX引擎中的重要的概念
### 刚体(Rigidbody)
刚体 (Rigidbody) 是实现游戏对象的物理行为的主要组件。连接刚体后，对象将立即响应重力。如果还添加了一个或多个碰撞体 (Collider)组件，则游戏对象会因发生碰撞而移动。  
- 刚体的一些属性  

属性： | 功能：
---|---
Mass|对象的质量（默认为千克）。
Drag|根据力移动对象时影响对象的空气阻力大小。0表示没有空气阻力，无穷大使对象立即停止移动。
Angular Drag|根据扭矩旋转对象时影响对象的空气阻力大小。0表示没有空气阻力。请注意，如果直接将对象的 Angular Drag 属性设置为无穷大，无法使对象停止旋转。
Use Gravity|如果启用此属性，则对象将受重力影响。
Is Kinematic|如果启用此选项，则对象将不会被物理引擎驱动，只能通过变换(Transform)对其进行操作。对于移动平台，或者如果要动画化附加了 HingeJoint的刚体，此属性将非常有用。
Interpolate|仅当在刚体运动中看到急动时才尝试使用提供的选项之一。
- None |不应用插值。
- Interpolate |根据前一帧的变换来平滑变换。
- Extrapolate |根据下一帧的估计变换来平滑变换。
Collision Detection|用于防止快速移动的对象穿过其他对象而不检测碰撞。
- Discrete|对场景中的所有其他碰撞体使用离散碰撞检测。其他碰撞体在测试碰撞时会使用离散碰撞检测。用于正常碰撞（这是默认值）。
- Continuous |对动态碰撞体（具有刚体）使用离散碰撞检测，并对静态碰撞体（没有刚体）使用基于扫掠的连续碰撞检测。设置为连续动态 (Continuous Dynamic) 的刚体将在测试与该刚体的碰撞时使用连续碰撞检测。其他刚体将使用离散碰撞检测。用于连续动态 (Continuous Dynamic) 检测需要碰撞的对象。（此属性对物理性能有很大影响，如果没有快速对象的碰撞问题，请将其保留为 Discrete 设置）
- Continuous Dynamic |对设置为连续 (Continuous)和连续动态 (Continuous Dynamic) 碰撞的游戏对象使用基于扫掠的连续碰撞检测。还将对静态碰撞体（没有刚体）使用连续碰撞检测。对于所有其他碰撞体，使用离散碰撞检测。用于快速移动的对象。
- Continuous Speculative |对刚体和碰撞体使用推测性连续碰撞检测。这也是可以设置运动物体的唯一 CCD 模式。该方法通常比基于扫掠的连续碰撞检测的成本更低。
Constraints|对刚体运动的限制：
- Freeze Position |有选择地停止刚体沿世界 X、Y 和 Z 轴的移动。
- Freeze Rotation |有选择地停止刚体围绕局部 X、Y 和 Z 轴旋转。

- **注意：在挂有刚体组件的Object上，如果要改变物体的位置，只能使用刚体中提供的物理操作AddForce() 和 AddTorque()，不能使用Transform来进行变换。**

- **关于IsKinematic属性：Kinematic意为运动学，如果需要把物体瞬间移动到某个位置而不受正常物理规则的限制，需要选择此项！**

### 碰撞器(Collider)
碰撞体 (Collider) 组件定义对象的形状以便用于物理碰撞。碰撞体是不可见的，其形状不需要与对象的网格完全相同，事实上，粗略近似方法通常更有效，在游戏运行过程中难以察觉。  
最简单（并且也是处理器开销最低）的碰撞体是所谓的原始碰撞体类型。在 3D 中，这些碰撞体为盒型碰撞体、球形碰撞体和胶囊碰撞体。在 2D 中，可以使用 2D 盒型碰撞体 和 2D 圆形碰撞体。可以将任意数量的上述碰撞体添加到单个对象以创建复合碰撞体。

#### 触发器
脚本系统可以使用 OnCollisionEnter 函数检测何时发生碰撞并启动操作。但是，也可以直接使用物理引擎检测碰撞体何时进入另一个对象的空间而不会产生碰撞。配置为触发器（使用 Is Trigger 属性）的碰撞体不会表现为实体对象，只会允许其他碰撞体穿过。当碰撞体进入其空间时，触发器将在触发器对象的脚本上调用 OnTriggerEnter 函数。

#### 脚本碰撞回调
发生碰撞时，物理引擎会在附加到相关对象的所有脚本上调用特定名称的函数。可以在这些函数中放置所需的任何代码来响应碰撞事件。例如，当汽车撞到障碍物时，可以播放碰撞音效。
在第一个检测到碰撞的物理更新中，将调用 OnCollisionEnter 函数。在保持接触的更新期间，将调用 OnCollisionStay，最后由 OnCollisionExit 指示接触已经中断。触发碰撞体会调用模拟的 OnTriggerEnter、OnTriggerStay 和 OnTriggerExit 函数。请注意，对于 2D 物理，可使用在名称中附加了 2D 字样的等效函数，例如 OnCollisionEnter2D。  
对于正常的非触发碰撞，还有一个额外的细节，即所涉及的对象中至少有一个对象必须具有非运动刚体（即，必须关闭 Is Kinematic）。如果两个对象都是运动刚体，则不会调用 OnCollisionEnter 等函数。对于触发碰撞，此限制不适用，因此运动和非运动刚体都会在进入触发碰撞体时提示调用 OnTriggerEnter。

#### 碰撞体相互作用
碰撞体彼此之间的相互作用根据刚体组件的配置不同而不同。三个重要的配置是静态碰撞体 (Static Collider)（即完全没有附加任何刚体）、刚体碰撞体 (Rigidbody Collider) 和运动刚体碰撞体 (Kinematic Rigidbody Collider)。

- 静态碰撞体  
**即没有rigidbody组件的碰撞体**，这是一种具有碰撞体但没有刚体的游戏对象。静态碰撞体用于表示关卡几何体，始终停留在同一个地方，永远不会四处移动。靠近的刚体对象将与静态碰撞体发生碰撞，但不会移动静态碰撞体。
物理引擎假定静态碰撞体永远不会移动或改变，并且可以基于此假设进行有用的优化。因此，在游戏运行过程中不应禁用/启用、移动或缩放静态碰撞体。如果更改静态碰撞体，则会导致物理引擎进行额外的内部重新计算，从而导致性能大幅下降。
- 刚体碰撞体  
**即具有rigidbody组件的碰撞体**这是一种附加了碰撞体和普通非运动刚体的游戏对象。刚体碰撞体完全由物理引擎模拟，并可响应通过脚本施加的碰撞和力。刚体碰撞体可与其他对象（包括静态碰撞体）碰撞，是使用物理组件的游戏中最常用的碰撞体配置。
- 运动刚体碰撞体  
这是一种附加了碰撞体和运动刚体（**即启用了刚体的 IsKinematic 属性**）的游戏对象。可使用脚本来移动运动刚体对象（通过修改对象的变换组件），但该对象不会像非运动刚体一样响应碰撞和力。运动刚体应该用于符合以下特征的碰撞体：偶尔可能被移动或禁用/启用，除此之外的行为应该像静态碰撞体一样。这方面的一个例子是滑动门，这种门通常用作不可移动的物理障碍物，但必要时可以打开。与静态碰撞体不同，移动的运动刚体会对其他对象施加摩擦力，并在双方接触时“唤醒”其他刚体。

#### 碰撞操作矩阵
当两个对象碰撞时，可能会发生许多不同的脚本事件，具体取决于碰撞对象的刚体配置。以下图表详细列出了根据附加到对象的组件来调用的事件函数。某些组合仅会使两个对象之中的一个对象受到碰撞的影响，但一般规则是物理特性不会应用于没有附加刚体组件的对象。  
- 发生碰撞检测并在碰撞后发送消息

\   | 静态碰撞体|刚体碰撞体|运动刚体碰撞体|静态触发碰撞体|刚体触发碰撞体|运动刚体触发碰撞体
---|---|---|---|---|---|---|---
静态碰撞体|   |是
刚体碰撞体|是|是|是
运动刚体碰撞体|  |是
静态触发碰撞体|
刚体触发碰撞体|
运动刚体触发碰撞体|

- 碰撞后发送触发器消息

\   | 静态碰撞体|刚体碰撞体|运动刚体碰撞体|静态触发碰撞体|刚体触发碰撞体|运动刚体触发碰撞体
---|---|---|---|---|---|---|---
静态碰撞体|   |  |  |  |是|是
刚体碰撞体|   |  |  |是|是|是
运动刚体碰撞体|   |  |  |是|是|是
静态触发碰撞体|  |是|是|  |是|是
刚体触发碰撞体|是|是|是|是|是|是|是
运动刚体触发碰撞体|是|是|是|是|是|是|是



